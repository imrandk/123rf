function createButton(e,t,n,r){const o=e.createElement("button");return o.textContent=t,o.style=`margin: 10px; padding: 10px 20px; border: none; border-radius: 5px; background: ${n}; color: #fff; font-size: 16px; cursor: pointer;`,o.onclick=r,o}function createTextArea(e,t,n,r){const o=e.createElement("textarea");return o.style=`width: 300px; height: ${r}; margin: 10px; padding: 10px; border: 2px solid ${n}; border-radius: 5px; font-size: 16px;`,o.placeholder=t,o}function createTextAreaWithCopy(e,t,n,r){const o=e.createElement("div");o.style="position: relative; width: 300px; margin: 10px;";const i=createTextArea(e,t,n,r),a=e.createElement("button");return a.textContent="Copy",a.style=`position: absolute; top: 10px; right: 10px; padding: 5px 10px; border: none; border-radius: 5px; background: ${n}; color: #fff; font-size: 12px; cursor: pointer;`,a.onclick=()=>copyText(i,e),o.append(i,a),o}function copyText(e,t){e.focus(),e.select(),t.hasFocus()?navigator.clipboard.writeText(e.value).catch((()=>{t.execCommand("copy")})):t.execCommand("copy")}function truncateTitle(e,t){if(e.length<=t)return e;let n=e.substring(0,t);const r=n.lastIndexOf(" ");return-1!==r&&(n=n.substring(0,r)),n}function createConverter(){const e=window.open("","_blank","width=800,height=600,top=100,left=100");if(!e)return;e.focus();const t=e.document.createElement("div");t.style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; align-items: flex-start; background: #f9f9f9; padding: 20px; border: 1px solid #ccc; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);";const n=e.document.createElement("div");n.style="display: flex; flex-direction: column; align-items: center;";const r=createTextArea(e.document,"Enter new file names here (one per line)...","#007bff","150px"),o=createTextAreaWithCopy(e.document,"Enter old titles here (one per line)...","#28a745","150px"),i=e.document.createElement("div");i.style="margin: 10px; font-size: 14px; color: #333; text-align: center;",i.textContent="Results will appear here after conversion.";const a=createButton(e.document,"Convert","#007bff",(()=>{const e=r.value.trim().split("\n").filter((e=>""!==e.trim())),t=o.querySelector("textarea").value.split("\n"),n=new Map;e.forEach((e=>{const t=e.split("\t");if(t.length>=2){const e=t[1].trim(),r=t[0].trim();n.set(e,r)}}));let a=0;o.querySelector("textarea").value=t.map((e=>{if(e.trim().startsWith("File Name: ")){const t=e.replace("File Name: ","").trim().split(".")[0];if(n.has(t)){const e=n.get(t);return a++,`File Name: ${e}`}}else if(e.trim().startsWith("Title: ")){let t=e.replace("Title: ","").trim();return t.length>90&&(t=truncateTitle(t,90)),`Title: ${t}`}return e})).join("\n"),i.textContent=`New File Names Found: ${e.length}, File Names Replaced: ${a}`}));n.append(r,o,a,i);const l=e.document.createElement("div");l.style="display: flex; flex-direction: column; align-items: center;";const c=createTextAreaWithCopy(e.document,"Cleaned titles will appear here...","#dc3545","320px"),s=e.document.createElement("div");s.style="margin: 10px; font-size: 14px; color: #333; text-align: center;",s.textContent="Cleaned titles count will appear here.";const p=createButton(e.document,"Clean Titles","#dc3545",(()=>{const e=c.querySelector("textarea").value.split("\n").filter((e=>e.trim().startsWith("File Name: "))).map((e=>e.replace("File Name: ","")));c.querySelector("textarea").value=e.join("\n\n"),s.textContent=`Titles Cleaned: ${e.length}`}));l.append(c,p,s),t.append(n,l),e.document.body.append(t),e.document.body.style="background: #f0f0f0; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh;"}createConverter();
