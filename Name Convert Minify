function createButton(e,t,n,r){const i=e.createElement("button");return i.textContent=t,i.style=`margin: 10px; padding: 10px 20px; border: none; border-radius: 5px; background: ${n}; color: #fff; font-size: 16px; cursor: pointer;`,i.onclick=r,i}function createTextArea(e,t,n,r){const i=e.createElement("textarea");return i.style=`width: 300px; height: ${r}; margin: 10px; padding: 10px; border: 2px solid ${n}; border-radius: 5px; font-size: 16px;`,i.placeholder=t,i}function extractID(e){const t=e.match(/imrandk\d+/);return t?t[0]:null}function trimToMaxLength(e,t){if(e.length<=t)return e;let n=e.substring(0,t);return n=n.substring(0,Math.min(n.length,n.lastIndexOf(" "))),n}function createConverter(){const e=window.open("","_blank","width=800,height=600,top=100,left=100");if(!e)return;const t=e.document.createElement("div");t.style="display: flex; justify-content: space-around; padding: 20px;";const n=e.document.createElement("div"),r=createTextArea(e.document,"Enter new file names here...","#007bff","150px"),i=createTextArea(e.document,"Enter old file names here...","#28a745","150px"),a=e.document.createElement("div");a.style="margin: 10px; font-size: 14px; color: #333; text-align: center;",a.textContent="Results will appear here after conversion.";const o=createButton(e.document,"Convert","#007bff",(()=>{const e=r.value.trim().split("\n").map((e=>e.trim())).filter((e=>""!==e)),t=i.value.split("\n"),n=new Map;e.forEach((e=>{const t=extractID(e);t&&n.set(t,e.split(t)[0].trim())}));let o=0;i.value=t.map((e=>{if(e.startsWith("File Name: ")){const t=extractID(e.replace("File Name: ","").trim());if(t&&n.has(t))return o++,`File Name: ${n.get(t)}`}return e})).join("\n"),a.textContent=`New File Names Found: ${e.length}, File Names Replaced: ${o}`})),l=e.document.createElement("div"),c=createTextArea(e.document,"Enter titles here...","#ffc107","150px"),s=e.document.createElement("div");s.style="margin: 10px; font-size: 14px; color: #333; text-align: center;",s.textContent="Trimmed results will appear here.";const p=createButton(e.document,"Trim Titles","#ffc107",(()=>{const e=c.value.split("\n");let t=e.filter((e=>e.startsWith("Title: "))).length,n=0;c.value=e.map((e=>{if(e.startsWith("Title: ")){const t=e.replace("Title: ","").trim();if(t.length>90)return n++,`Title: ${trimToMaxLength(t,90)}`}return e})).join("\n"),s.textContent=`Total Titles: ${t}, Titles Trimmed: ${n}`}));l.append(c,p,s),n.append(r,i,o,a),t.append(n,l),e.document.body.append(t)}createConverter();
